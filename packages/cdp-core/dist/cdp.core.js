/*!
 * cdp.core.js 2.0.0
 *
 * Date: 2017-07-26T11:46:12.175Z
 */
(function (root, factory) { if (typeof define === "function" && define.amd) { define(function () { return factory(root.CDP || (root.CDP = {})); }); } else if (typeof exports === "object") { module.exports = factory(root.CDP || (root.CDP = {})); } else { factory(root.CDP || (root.CDP = {})); } }(((this || 0).self || global), function (CDP) {
var CDP;
(function (CDP) {
    var TAG = "[CDP] ";
    /**
     * システムの global オブジェクトにアクセス
     * 通常は Window オブジェクトとなる
     */
    CDP.global = Function("return this")();
    /**
     * Web root location にアクセス
     */
    CDP.webRoot = (function () {
        if (CDP.global.location) {
            var baseUrl = /(.+\/)[^/]*#[^/]+/.exec(CDP.global.location.href);
            if (!baseUrl) {
                baseUrl = /(.+\/)/.exec(CDP.global.location.href);
            }
            return baseUrl[1];
        }
    })();
    /**
     * Config オブジェクトにアクセス
     */
    CDP.Config = CDP.Config || CDP.global.Config || {};
    /**
     * core の初期化
     */
    function initialize(options) {
        setTimeout(function () {
            try {
                CDP.Patch.apply();
                if (options && typeof options.success === "function") {
                    options.success();
                }
            }
            catch (error) {
                var errorInfo = CDP.makeErrorInfo(CDP.RESULT_CODE.ERROR_CDP_INITIALIZE_FAILED, TAG, (error && error.message) ? error.message : null, error);
                console.error(errorInfo.message);
                if (options && typeof options.fail === "function") {
                    options.fail(errorInfo);
                }
            }
        });
    }
    CDP.initialize = initialize;
})(CDP || (CDP = {}));
var CDP;
(function (CDP) {
    var TAG = "[CDP.Patch] ";
    /**
     * @class Patch
     * @brief 実行環境用 Patch 適用ユーティリティクラス
     */
    var Patch = (function () {
        function Patch() {
        }
        ///////////////////////////////////////////////////////////////////////
        // public static methods:
        /**
         * パッチの適用
         */
        Patch.apply = function () {
            Patch.consolePatch();
            Patch.nodePatch();
        };
        ///////////////////////////////////////////////////////////////////////
        // private static methods:
        // console 用 patch
        Patch.consolePatch = function () {
            if (null == CDP.global.console || null == CDP.global.console.error) {
                CDP.global.console = {
                    count: function () { },
                    groupEnd: function () { },
                    time: function () { },
                    timeEnd: function () { },
                    trace: function () { },
                    group: function () { },
                    dirxml: function () { },
                    debug: function () { },
                    groupCollapsed: function () { },
                    select: function () { },
                    info: function () { },
                    profile: function () { },
                    assert: function () { },
                    msIsIndependentlyComposed: function () { },
                    clear: function () { },
                    dir: function () { },
                    warn: function () { },
                    error: function () { },
                    log: function () { },
                    profileEnd: function () { }
                };
            }
        };
        // WinRT 用 patch
        Patch.nodePatch = function () {
            if ("object" === typeof MSApp) {
                var _MSApp_1 = MSApp;
                var originalAppendChild_1 = Node.prototype.appendChild;
                Node.prototype.appendChild = function (node) {
                    var self = this;
                    return _MSApp_1.execUnsafeLocalFunction(function () {
                        return originalAppendChild_1.call(self, node);
                    });
                };
                var originalInsertBefore_1 = Node.prototype.insertBefore;
                Node.prototype.insertBefore = function (newElement, referenceElement) {
                    var self = this;
                    return _MSApp_1.execUnsafeLocalFunction(function () {
                        return originalInsertBefore_1.call(self, newElement, referenceElement);
                    });
                };
            }
        };
        return Patch;
    }());
    CDP.Patch = Patch;
})(CDP || (CDP = {}));
var __assign = (this && this.__assign) || Object.assign || function(t) {
    for (var s, i = 1, n = arguments.length; i < n; i++) {
        s = arguments[i];
        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))
            t[p] = s[p];
    }
    return t;
};
var CDP;
(function (CDP) {
    var CANCELED_MESSAGE = "abort";
    var s_code2message = {
        "0": "operation succeeded.",
        "1": "operation canceled.",
        "-1": "operation failed."
    };
    ///////////////////////////////////////////////////////////////////////
    // error utilities:
    /**
     * @enum  RESULT_CODE
     * @brief アプリケーション全体で使用する共通エラーコード定義
     */
    var RESULT_CODE;
    (function (RESULT_CODE) {
        RESULT_CODE[RESULT_CODE["SUCCEEDED"] = 0] = "SUCCEEDED";
        RESULT_CODE[RESULT_CODE["CANCELED"] = 1] = "CANCELED";
        RESULT_CODE[RESULT_CODE["FAILED"] = -1] = "FAILED";
    })(RESULT_CODE = CDP.RESULT_CODE || (CDP.RESULT_CODE = {}));
    // ローカルリザルトコードのアサイン可能数
    CDP.MODULE_RESULT_CODE_RANGE = 1000;
    /**
     * エラー情報生成
     *
     * @param resultCode [in] RESULT_CODE を指定
     * @param [tag]      [in] TAG を指定
     * @param [message]  [in] メッセージを指定
     * @param [cause]    [in] 下位のエラーを指定
     * @returns エラーオブジェクト
     */
    function makeErrorInfo(resultCode, tag, message, cause) {
        var canceled = (cause && CANCELED_MESSAGE === cause.message) ? true : false;
        var msg = canceled ? CANCELED_MESSAGE : message;
        var code = canceled ? RESULT_CODE.CANCELED : resultCode;
        return __assign({}, new Error(msg || messageFromResultCode(code)), {
            name: buildErrorName(code, tag),
            code: code,
            cause: cause,
        });
    }
    CDP.makeErrorInfo = makeErrorInfo;
    /**
     * キャンセルエラー情報生成
     *
     * @param [tag]      [in] TAG を指定
     * @param [cause]    [in] 下位のエラーを指定
     * @returns エラーオブジェクト
     */
    function makeCanceledErrorInfo(tag, cause) {
        return makeErrorInfo(RESULT_CODE.CANCELED, tag, CANCELED_MESSAGE, cause);
    }
    CDP.makeCanceledErrorInfo = makeCanceledErrorInfo;
    /**
     * エラー情報がキャンセルされたものか判定
     *
     * @param error [in] エラー情報
     * @returns true: キャンセル / false: その他エラー
     */
    function isCanceledError(error) {
        var errorInfo = error;
        if (errorInfo) {
            if (RESULT_CODE.CANCELED === errorInfo.code || CANCELED_MESSAGE === errorInfo.message) {
                return true;
            }
        }
        return false;
    }
    CDP.isCanceledError = isCanceledError;
    /**
     * 入力を ErrorInfo に変換
     *
     * @param cause [in] 入力
     * @returns ErrorInfo オブジェクト
     */
    function ensureErrorInfo(cause) {
        var errorInfo = cause;
        var unknown = {
            name: "",
            code: RESULT_CODE.FAILED,
            message: "unknown error",
        };
        if (errorInfo) {
            if (isCanceledError(errorInfo)) {
                return errorInfo;
            }
            else if ("string" === typeof cause) {
                return __assign({}, unknown, { message: cause });
            }
            else if ("object" === typeof cause) {
                return __assign({}, unknown, cause);
            }
        }
        return unknown;
    }
    CDP.ensureErrorInfo = ensureErrorInfo;
    CDP.MODULE_RESULT_CODE_RANGE_CDP = 100;
    /**
     * @enum  RESULT_CODE_BASE
     * @brief リザルトコードのオフセット値
     *        エラーコード対応するモジュール内で 定義を拡張する.
     */
    var RESULT_CODE_BASE;
    (function (RESULT_CODE_BASE) {
        RESULT_CODE_BASE[RESULT_CODE_BASE["CDP_DECLARERATION"] = 0] = "CDP_DECLARERATION";
        //      MODULE_A = 1 * MODULE_RESULT_CODE_RANGE,    // ex) moduleA: abs(1001 ～ 1999)
        //      MODULE_B = 2 * MODULE_RESULT_CODE_RANGE,    // ex) moduleB: abs(2001 ～ 2999)
        //      MODULE_C = 3 * MODULE_RESULT_CODE_RANGE,    // ex) moduleC: abs(3001 ～ 3999)
        RESULT_CODE_BASE[RESULT_CODE_BASE["CDP"] = 1 * CDP.MODULE_RESULT_CODE_RANGE_CDP] = "CDP";
    })(RESULT_CODE_BASE = CDP.RESULT_CODE_BASE || (CDP.RESULT_CODE_BASE = {}));
    // "CDP" 以外の namespace で定義した場合は、ASSIGN ユーティリティをコールする.
    //  ASSIGN_RESULT_CODE_BASE(RESULT_CODE_BASE);
    // サクセスコード生成
    function DECLARE_SUCCESS_CODE(base, localCode, message) {
        if ("string" === typeof base) {
            base = CDP.RESULT_CODE_BASE[base];
        }
        return declareResultCode(base, localCode, message, true);
    }
    CDP.DECLARE_SUCCESS_CODE = DECLARE_SUCCESS_CODE;
    // エラーコード生成
    function DECLARE_ERROR_CODE(base, localCode, message) {
        if ("string" === typeof base) {
            base = CDP.RESULT_CODE_BASE[base];
        }
        return declareResultCode(base, localCode, message, false);
    }
    CDP.DECLARE_ERROR_CODE = DECLARE_ERROR_CODE;
    // 成功判定
    function SUCCEEDED(code) {
        return 0 <= code;
    }
    CDP.SUCCEEDED = SUCCEEDED;
    // 失敗判定
    function FAILED(code) {
        return code < 0;
    }
    CDP.FAILED = FAILED;
    /**
     * RESULT_CODE_BASE のアサイン
     */
    function ASSIGN_RESULT_CODE_BASE(resultCodeBase) {
        CDP.RESULT_CODE_BASE = __assign({}, CDP.RESULT_CODE_BASE, resultCodeBase);
    }
    CDP.ASSIGN_RESULT_CODE_BASE = ASSIGN_RESULT_CODE_BASE;
    /**
     * RESULT_CODE のアサイン
     */
    function ASSIGN_RESULT_CODE(resultCode) {
        CDP.RESULT_CODE = __assign({}, CDP.RESULT_CODE, resultCode);
    }
    CDP.ASSIGN_RESULT_CODE = ASSIGN_RESULT_CODE;
    ///////////////////////////////////////////////////////////////////////
    // module error declaration:
    var FUNCTION_CODE_RANGE = 10;
    /**
     * @enum  LOCAL_CODE_BASE
     * @brief cdp.core 内のローカルコードオフセット値
     */
    var LOCAL_CODE_BASE;
    (function (LOCAL_CODE_BASE) {
        LOCAL_CODE_BASE[LOCAL_CODE_BASE["CORE"] = 0] = "CORE";
        LOCAL_CODE_BASE[LOCAL_CODE_BASE["PATCH"] = 1 * FUNCTION_CODE_RANGE] = "PATCH";
    })(LOCAL_CODE_BASE || (LOCAL_CODE_BASE = {}));
    /**
     * @enum  RESULT_CODE
     * @brief cdp.core のエラーコード定義
     *        モジュール別に拡張可能
     */
    (function (RESULT_CODE) {
        RESULT_CODE[RESULT_CODE["ERROR_CDP_DECLARATION_CDP"] = 0] = "ERROR_CDP_DECLARATION_CDP";
        RESULT_CODE[RESULT_CODE["ERROR_CDP_INITIALIZE_FAILED"] = DECLARE_ERROR_CODE(RESULT_CODE_BASE.CDP, LOCAL_CODE_BASE.CORE + 1, "initialized failed.")] = "ERROR_CDP_INITIALIZE_FAILED";
    })(RESULT_CODE = CDP.RESULT_CODE || (CDP.RESULT_CODE = {}));
    // "CDP" 以外の namespace で定義した場合は、ASSIGN ユーティリティをコールする.
    //  ASSIGN_RESULT_CODE_BASE(RESULT_CODE);
    ///////////////////////////////////////////////////////////////////////
    // private static methods:
    /**
     * リザルトコードの登録
     *
     * @param base       [in] RESULT_CODE_BASE を指定
     * @param moduleCode [in] モジュールで一意になる数値 (0 < localCode < 1000)
     * @param [message]  [in] リザルトコードに紐づくメッセージ
     * @returns リザルトコード
     */
    function declareResultCode(base, moduleCode, message, succeeded) {
        if (succeeded === void 0) { succeeded = false; }
        if (moduleCode <= 0 || CDP.MODULE_RESULT_CODE_RANGE <= moduleCode) {
            console.error("declareResultCode(), invalid localCode range. [localCode: " + moduleCode + "]");
            return;
        }
        var signed = succeeded ? 1 : -1;
        var resultCode = signed * (base + moduleCode);
        s_code2message[resultCode] = message ? message : ("[RESULT_CODE: " + resultCode + "]");
        return resultCode;
    }
    /**
     * リザルトコードから登録されているメッセージを取得
     *
     * @param resultCode [in] リザルトコード
     * @returns エラーメッセージ
     */
    function messageFromResultCode(resultCode) {
        if (s_code2message[resultCode]) {
            return s_code2message[resultCode];
        }
        else {
            return "unregistered result code. [RESULT_CODE: " + resultCode + "]";
        }
    }
    /**
     * リザルトコードから登録されているリザルトコード文字列を取得
     *
     * @param resultCode [in] リザルトコード
     * @param tag        [in] TAG を指定
     * @returns リザルトコード識別文字列
     */
    function buildErrorName(resultCode, tag) {
        var prefix = tag || "";
        if (RESULT_CODE[resultCode]) {
            return prefix + RESULT_CODE[resultCode] + ": ";
        }
        else {
            return prefix;
        }
    }
})(CDP || (CDP = {}));

return CDP; }));
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNkcDovLy9DRFAvQ29yZS50cyIsImNkcDovLy9DRFAvUGF0Y2gudHMiLCJjZHA6Ly8vQ0RQL0Vycm9yRGVmcy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxJQUFVLEdBQUcsQ0E4RFo7QUE5REQsV0FBVSxHQUFHO0lBRVQsSUFBTSxHQUFHLEdBQUcsUUFBUSxDQUFDO0lBRXJCOzs7T0FHRztJQUNVLFVBQU0sR0FBUSxRQUFRLENBQUMsYUFBYSxDQUFDLEVBQUUsQ0FBQztJQUdyRDs7T0FFRztJQUNVLFdBQU8sR0FBVyxDQUFDO1FBQzVCLEVBQUUsQ0FBQyxDQUFDLFVBQU0sQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDO1lBQ2xCLElBQUksT0FBTyxHQUFHLG1CQUFtQixDQUFDLElBQUksQ0FBQyxVQUFNLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDO1lBQzdELEVBQUUsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQztnQkFDWCxPQUFPLEdBQUcsUUFBUSxDQUFDLElBQUksQ0FBQyxVQUFNLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDO1lBQ2xELENBQUM7WUFDRCxNQUFNLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQ3RCLENBQUM7SUFDTCxDQUFDLENBQUMsRUFBRSxDQUFDO0lBRUw7O09BRUc7SUFDVSxVQUFNLEdBQVEsR0FBRyxDQUFDLE1BQU0sSUFBSSxVQUFNLENBQUMsTUFBTSxJQUFJLEVBQUUsQ0FBQztJQVc3RDs7T0FFRztJQUNILG9CQUEyQixPQUF5QjtRQUNoRCxVQUFVLENBQUM7WUFDUCxJQUFJLENBQUM7Z0JBQ0QsU0FBSyxDQUFDLEtBQUssRUFBRSxDQUFDO2dCQUNkLEVBQUUsQ0FBQyxDQUFDLE9BQU8sSUFBSSxPQUFPLE9BQU8sQ0FBQyxPQUFPLEtBQUssVUFBVSxDQUFDLENBQUMsQ0FBQztvQkFDbkQsT0FBTyxDQUFDLE9BQU8sRUFBRSxDQUFDO2dCQUN0QixDQUFD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O0lBQ0gsK0JBQStCLFVBQWtCO1FBQzdDLEVBQUUsQ0FBQyxDQUFDLGNBQWMsQ0FBQyxVQUFVLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDN0IsTUFBTSxDQUFDLGNBQWMsQ0FBQyxVQUFVLENBQUMsQ0FBQztRQUN0QyxDQUFDO1FBQUMsSUFBSSxDQUFDLENBQUM7WUFDSixNQUFNLENBQUMsNkNBQTJDLFVBQVUsTUFBRyxDQUFDO1FBQ3BFLENBQUM7SUFDTCxDQUFDO0lBRUQ7Ozs7OztPQU1HO0lBQ0gsd0JBQXdCLFVBQWtCLEVBQUUsR0FBVztRQUNuRCxJQUFNLE1BQU0sR0FBRyxHQUFHLElBQUksRUFBRSxDQUFDO1FBQ3pCLEVBQUUsQ0FBQyxDQUFDLFdBQVcsQ0FBQyxVQUFVLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDMUIsTUFBTSxDQUFDLE1BQU0sR0FBRyxXQUFXLENBQUMsVUFBVSxDQUFDLEdBQUcsSUFBSSxDQUFDO1FBQ25ELENBQUM7UUFBQyxJQUFJLENBQUMsQ0FBQztZQUNKLE1BQU0sQ0FBQyxNQUFNLENBQUM7UUFDbEIsQ0FBQztJQUNMLENBQUM7QUFDTCxDQUFDLEVBcFBTLEdBQUcsS0FBSCxHQUFHLFFBb1BaIiwic291cmNlc0NvbnRlbnQiOlsibmFtZXNwYWNlIENEUCB7XHJcblxyXG4gICAgY29uc3QgVEFHID0gXCJbQ0RQXSBcIjtcclxuXHJcbiAgICAvKipcclxuICAgICAqIOOCt+OCueODhuODoOOBriBnbG9iYWwg44Kq44OW44K444Kn44Kv44OI44Gr44Ki44Kv44K744K5XHJcbiAgICAgKiDpgJrluLjjga8gV2luZG93IOOCquODluOCuOOCp+OCr+ODiOOBqOOBquOCi1xyXG4gICAgICovXHJcbiAgICBleHBvcnQgY29uc3QgZ2xvYmFsOiBhbnkgPSBGdW5jdGlvbihcInJldHVybiB0aGlzXCIpKCk7XHJcblxyXG5cclxuICAgIC8qKlxyXG4gICAgICogV2ViIHJvb3QgbG9jYXRpb24g44Gr44Ki44Kv44K744K5XHJcbiAgICAgKi9cclxuICAgIGV4cG9ydCBjb25zdCB3ZWJSb290OiBzdHJpbmcgPSAoKCkgPT4ge1xyXG4gICAgICAgIGlmIChnbG9iYWwubG9jYXRpb24pIHtcclxuICAgICAgICAgICAgbGV0IGJhc2VVcmwgPSAvKC4rXFwvKVteL10qI1teL10rLy5leGVjKGdsb2JhbC5sb2NhdGlvbi5ocmVmKTtcclxuICAgICAgICAgICAgaWYgKCFiYXNlVXJsKSB7XHJcbiAgICAgICAgICAgICAgICBiYXNlVXJsID0gLyguK1xcLykvLmV4ZWMoZ2xvYmFsLmxvY2F0aW9uLmhyZWYpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBiYXNlVXJsWzFdO1xyXG4gICAgICAgIH1cclxuICAgIH0pKCk7XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDb25maWcg44Kq44OW44K444Kn44Kv44OI44Gr44Ki44Kv44K744K5XHJcbiAgICAgKi9cclxuICAgIGV4cG9ydCBjb25zdCBDb25maWc6IGFueSA9IENEUC5Db25maWcgfHwgZ2xvYmFsLkNvbmZpZyB8fCB7fTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIOWIneacn+WMluOCquODl+OCt+ODp+ODs+OCpOODs+OCv+ODvOODleOCp+OCpOOCuVxyXG4gICAgICovXHJcbiAgICBleHBvcnQgaW50ZXJmYWNlIENvcmVJbml0T3B0aW9ucyB7XHJcbiAgICAgICAgc3VjY2Vzcz86ICgpID0+IHZvaWQ7XHJcbiAgICAgICAgZmFpbD86IChlcnJvcj86IGFueSkgPT4gdm9pZDtcclxuICAgICAgICBba2V5OiBzdHJpbmddOiBhbnk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBjb3JlIOOBruWIneacn+WMllxyXG4gICAgICovXHJcbiAgICBleHBvcnQgZnVuY3Rpb24gaW5pdGlhbGl6ZShvcHRpb25zPzogQ29yZUluaXRPcHRpb25zKTogdm9pZCB7XHJcbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICBQYXRjaC5hcHBseSgpO1xyXG4gICAgICAgICAgICAgICAgaWYgKG9wdGlvbnMgJiYgdHlwZW9mIG9wdGlvbnMuc3VjY2VzcyA9PT0gXCJmdW5jdGlvblwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5zdWNjZXNzKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlcnJvckluZm8gPSBtYWtlRXJyb3JJbmZvKFxyXG4gICAgICAgICAgICAgICAgICAgIFJFU1VMVF9DT0RFLkVSUk9SX0NEUF9JTklUSUFMSVpFX0ZBSUxFRCxcclxuICAgICAgICAgICAgICAgICAgICBUQUcsXHJcbiAgICAgICAgICAgICAgICAgICAgKGVycm9yICYmIGVycm9yLm1lc3NhZ2UpID8gZXJyb3IubWVzc2FnZSA6IG51bGwsXHJcbiAgICAgICAgICAgICAgICAgICAgZXJyb3JcclxuICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGVycm9ySW5mby5tZXNzYWdlKTtcclxuICAgICAgICAgICAgICAgIGlmIChvcHRpb25zICYmIHR5cGVvZiBvcHRpb25zLmZhaWwgPT09IFwiZnVuY3Rpb25cIikge1xyXG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZmFpbChlcnJvckluZm8pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbn1cclxuXHJcbmRlY2xhcmUgbW9kdWxlIFwiY2RwLmNvcmVcIiB7XHJcbiAgICBleHBvcnQgPSBDRFA7XHJcbn1cclxuIiwibmFtZXNwYWNlIENEUCB7XHJcblxyXG4gICAgY29uc3QgVEFHOiBzdHJpbmcgPSBcIltDRFAuUGF0Y2hdIFwiO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogQGNsYXNzIFBhdGNoXHJcbiAgICAgKiBAYnJpZWYg5a6f6KGM55Kw5aKD55SoIFBhdGNoIOmBqeeUqOODpuODvOODhuOCo+ODquODhuOCo+OCr+ODqeOCuVxyXG4gICAgICovXHJcbiAgICBleHBvcnQgY2xhc3MgUGF0Y2gge1xyXG4gICAgICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXHJcbiAgICAgICAgLy8gcHVibGljIHN0YXRpYyBtZXRob2RzOlxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDjg5Hjg4Pjg4Hjga7pgannlKhcclxuICAgICAgICAgKi9cclxuICAgICAgICBwdWJsaWMgc3RhdGljIGFwcGx5KCk6IHZvaWQge1xyXG4gICAgICAgICAgICBQYXRjaC5jb25zb2xlUGF0Y2goKTtcclxuICAgICAgICAgICAgUGF0Y2gubm9kZVBhdGNoKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xyXG4gICAgICAgIC8vIHByaXZhdGUgc3RhdGljIG1ldGhvZHM6XHJcblxyXG4gICAgICAgIC8vIGNvbnNvbGUg55SoIHBhdGNoXHJcbiAgICAgICAgcHJpdmF0ZSBzdGF0aWMgY29uc29sZVBhdGNoKCk6IHZvaWQge1xyXG4gICAgICAgICAgICBpZiAobnVsbCA9PSBnbG9iYWwuY29uc29sZSB8fCBudWxsID09IGdsb2JhbC5jb25zb2xlLmVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICBnbG9iYWwuY29uc29sZSA9IHtcclxuICAgICAgICAgICAgICAgICAgICBjb3VudDogICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKCkgeyAvKiBkdW1teSAqLyB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGdyb3VwRW5kOiAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoKSB7IC8qIGR1bW15ICovIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgdGltZTogICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uICgpIHsgLyogZHVtbXkgKi8gfSxcclxuICAgICAgICAgICAgICAgICAgICB0aW1lRW5kOiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKCkgeyAvKiBkdW1teSAqLyB9LFxyXG4gICAgICAgICAgICAgICAgICAgIHRyYWNlOiAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoKSB7IC8qIGR1bW15ICovIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgZ3JvdXA6ICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uICgpIHsgLyogZHVtbXkgKi8gfSxcclxuICAgICAgICAgICAgICAgICAgICBkaXJ4bWw6ICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKCkgeyAvKiBkdW1teSAqLyB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGRlYnVnOiAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoKSB7IC8qIGR1bW15ICovIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgZ3JvdXBDb2xsYXBzZWQ6ICAgICAgICAgICAgIGZ1bmN0aW9uICgpIHsgLyogZHVtbXkgKi8gfSxcclxuICAgICAgICAgICAgICAgICAgICBzZWxlY3Q6ICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKCkgeyAvKiBkdW1teSAqLyB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGluZm86ICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoKSB7IC8qIGR1bW15ICovIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgcHJvZmlsZTogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uICgpIHsgLyogZHVtbXkgKi8gfSxcclxuICAgICAgICAgICAgICAgICAgICBhc3NlcnQ6ICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKCkgeyAvKiBkdW1teSAqLyB9LFxyXG4gICAgICAgICAgICAgICAgICAgIG1zSXNJbmRlcGVuZGVudGx5Q29tcG9zZWQ6ICBmdW5jdGlvbiAoKSB7IC8qIGR1bW15ICovIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgY2xlYXI6ICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uICgpIHsgLyogZHVtbXkgKi8gfSxcclxuICAgICAgICAgICAgICAgICAgICBkaXI6ICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKCkgeyAvKiBkdW1teSAqLyB9LFxyXG4gICAgICAgICAgICAgICAgICAgIHdhcm46ICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoKSB7IC8qIGR1bW15ICovIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uICgpIHsgLyogZHVtbXkgKi8gfSxcclxuICAgICAgICAgICAgICAgICAgICBsb2c6ICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKCkgeyAvKiBkdW1teSAqLyB9LFxyXG4gICAgICAgICAgICAgICAgICAgIHByb2ZpbGVFbmQ6ICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoKSB7IC8qIGR1bW15ICovIH1cclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIFdpblJUIOeUqCBwYXRjaFxyXG4gICAgICAgIHByaXZhdGUgc3RhdGljIG5vZGVQYXRjaCgpOiB2b2lkIHtcclxuICAgICAgICAgICAgaWYgKFwib2JqZWN0XCIgPT09IHR5cGVvZiBNU0FwcCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgX01TQXBwOiBhbnkgPSBNU0FwcDtcclxuXHJcbiAgICAgICAgICAgICAgICBjb25zdCBvcmlnaW5hbEFwcGVuZENoaWxkID0gTm9kZS5wcm90b3R5cGUuYXBwZW5kQ2hpbGQ7XHJcbiAgICAgICAgICAgICAgICBOb2RlLnByb3RvdHlwZS5hcHBlbmRDaGlsZCA9IGZ1bmN0aW9uIChub2RlOiBhbnkpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBzZWxmID0gdGhpcztcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gX01TQXBwLmV4ZWNVbnNhZmVMb2NhbEZ1bmN0aW9uKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG9yaWdpbmFsQXBwZW5kQ2hpbGQuY2FsbChzZWxmLCBub2RlKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICAgICAgY29uc3Qgb3JpZ2luYWxJbnNlcnRCZWZvcmUgPSBOb2RlLnByb3RvdHlwZS5pbnNlcnRCZWZvcmU7XHJcbiAgICAgICAgICAgICAgICBOb2RlLnByb3RvdHlwZS5pbnNlcnRCZWZvcmUgPSBmdW5jdGlvbiAobmV3RWxlbWVudDogYW55LCByZWZlcmVuY2VFbGVtZW50OiBOb2RlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9NU0FwcC5leGVjVW5zYWZlTG9jYWxGdW5jdGlvbihmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBvcmlnaW5hbEluc2VydEJlZm9yZS5jYWxsKHNlbGYsIG5ld0VsZW1lbnQsIHJlZmVyZW5jZUVsZW1lbnQpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG4iLCJuYW1lc3BhY2UgQ0RQIHtcclxuXHJcbiAgICBjb25zdCBDQU5DRUxFRF9NRVNTQUdFID0gXCJhYm9ydFwiO1xyXG4gICAgY29uc3Qgc19jb2RlMm1lc3NhZ2U6IHsgW3Jlc3VsdENvZGU6IHN0cmluZ106IHN0cmluZyB9ID0ge1xyXG4gICAgICAgIFwiMFwiOiBcIm9wZXJhdGlvbiBzdWNjZWVkZWQuXCIsXHJcbiAgICAgICAgXCIxXCI6IFwib3BlcmF0aW9uIGNhbmNlbGVkLlwiLFxyXG4gICAgICAgIFwiLTFcIjogXCJvcGVyYXRpb24gZmFpbGVkLlwiXHJcbiAgICB9O1xyXG5cclxuICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXHJcbiAgICAvLyBlcnJvciB1dGlsaXRpZXM6XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAZW51bSAgUkVTVUxUX0NPREVcclxuICAgICAqIEBicmllZiDjgqLjg5fjg6rjgrHjg7zjgrfjg6fjg7PlhajkvZPjgafkvb/nlKjjgZnjgovlhbHpgJrjgqjjg6njg7zjgrPjg7zjg4nlrprnvqlcclxuICAgICAqL1xyXG4gICAgZXhwb3J0IGVudW0gUkVTVUxUX0NPREUge1xyXG4gICAgICAgIFNVQ0NFRURFRCAgID0gMCwgICAgLy8g5rGO55So5oiQ5YqfXHJcbiAgICAgICAgQ0FOQ0VMRUQgICAgPSAxLCAgICAvLyDmsY7nlKjjgq3jg6Pjg7Pjgrvjg6tcclxuICAgICAgICBGQUlMRUQgICAgICA9IC0xLCAgIC8vIOaxjueUqOOBruOCqOODqeODvFxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQGludGVyZmFjZSBFcnJvckluZm9cclxuICAgICAqIEBicmllZiAgICAg44Ko44Op44O85Lyd6YGU44Kq44OW44K444Kn44Kv44OIXHJcbiAgICAgKi9cclxuICAgIGV4cG9ydCBpbnRlcmZhY2UgRXJyb3JJbmZvIGV4dGVuZHMgRXJyb3Ige1xyXG4gICAgICAgIGNvZGU6IFJFU1VMVF9DT0RFOyAgIC8vIOOCouODl+ODquOCseODvOOCt+ODp+ODsy/jg6njgqTjg5bjg6njg6rjgaflrprnvqnjgZnjgovjg6rjgrbjg6vjg4jjgrPjg7zjg4lcclxuICAgICAgICBjYXVzZT86IEVycm9yOyAgICAgICAvLyDjgqjjg6njg7zjga7oqbPntLBcclxuICAgIH1cclxuXHJcbiAgICAvLyDjg63jg7zjgqvjg6vjg6rjgrbjg6vjg4jjgrPjg7zjg4njga7jgqLjgrXjgqTjg7Plj6/og73mlbBcclxuICAgIGV4cG9ydCBjb25zdCBNT0RVTEVfUkVTVUxUX0NPREVfUkFOR0UgPSAxMDAwO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICog44Ko44Op44O85oOF5aCx55Sf5oiQXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHJlc3VsdENvZGUgW2luXSBSRVNVTFRfQ09ERSDjgpLmjIflrppcclxuICAgICAqIEBwYXJhbSBbdGFnXSAgICAgIFtpbl0gVEFHIOOCkuaMh+WumlxyXG4gICAgICogQHBhcmFtIFttZXNzYWdlXSAgW2luXSDjg6Hjg4Pjgrvjg7zjgrjjgpLmjIflrppcclxuICAgICAqIEBwYXJhbSBbY2F1c2VdICAgIFtpbl0g5LiL5L2N44Gu44Ko44Op44O844KS5oyH5a6aXHJcbiAgICAgKiBAcmV0dXJucyDjgqjjg6njg7zjgqrjg5bjgrjjgqfjgq/jg4hcclxuICAgICAqL1xyXG4gICAgZXhwb3J0IGZ1bmN0aW9uIG1ha2VFcnJvckluZm8ocmVzdWx0Q29kZTogbnVtYmVyLCB0YWc/OiBzdHJpbmcsIG1lc3NhZ2U/OiBzdHJpbmcsIGNhdXNlPzogRXJyb3IpOiBFcnJvckluZm8ge1xyXG4gICAgICAgIGNvbnN0IGNhbmNlbGVkID0gKGNhdXNlICYmIENBTkNFTEVEX01FU1NBR0UgPT09IGNhdXNlLm1lc3NhZ2UpID8gdHJ1ZSA6IGZhbHNlO1xyXG4gICAgICAgIGNvbnN0IG1zZyA9IGNhbmNlbGVkID8gQ0FOQ0VMRURfTUVTU0FHRSA6IG1lc3NhZ2U7XHJcbiAgICAgICAgY29uc3QgY29kZSA9IGNhbmNlbGVkID8gUkVTVUxUX0NPREUuQ0FOQ0VMRUQgOiByZXN1bHRDb2RlO1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIC4uLm5ldyBFcnJvcihtc2cgfHwgbWVzc2FnZUZyb21SZXN1bHRDb2RlKGNvZGUpKSxcclxuICAgICAgICAgICAgLi4ue1xyXG4gICAgICAgICAgICAgICAgbmFtZTogYnVpbGRFcnJvck5hbWUoY29kZSwgdGFnKSxcclxuICAgICAgICAgICAgICAgIGNvZGU6IGNvZGUsXHJcbiAgICAgICAgICAgICAgICBjYXVzZTogY2F1c2UsXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog44Kt44Oj44Oz44K744Or44Ko44Op44O85oOF5aCx55Sf5oiQXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIFt0YWddICAgICAgW2luXSBUQUcg44KS5oyH5a6aXHJcbiAgICAgKiBAcGFyYW0gW2NhdXNlXSAgICBbaW5dIOS4i+S9jeOBruOCqOODqeODvOOCkuaMh+WumlxyXG4gICAgICogQHJldHVybnMg44Ko44Op44O844Kq44OW44K444Kn44Kv44OIXHJcbiAgICAgKi9cclxuICAgIGV4cG9ydCBmdW5jdGlvbiBtYWtlQ2FuY2VsZWRFcnJvckluZm8odGFnPzogc3RyaW5nLCBjYXVzZT86IEVycm9yKTogRXJyb3JJbmZvIHtcclxuICAgICAgICByZXR1cm4gbWFrZUVycm9ySW5mbyhSRVNVTFRfQ09ERS5DQU5DRUxFRCwgdGFnLCBDQU5DRUxFRF9NRVNTQUdFLCBjYXVzZSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDjgqjjg6njg7zmg4XloLHjgYzjgq3jg6Pjg7Pjgrvjg6vjgZXjgozjgZ/jgoLjga7jgYvliKTlrppcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gZXJyb3IgW2luXSDjgqjjg6njg7zmg4XloLFcclxuICAgICAqIEByZXR1cm5zIHRydWU6IOOCreODo+ODs+OCu+ODqyAvIGZhbHNlOiDjgZ3jga7ku5bjgqjjg6njg7xcclxuICAgICAqL1xyXG4gICAgZXhwb3J0IGZ1bmN0aW9uIGlzQ2FuY2VsZWRFcnJvcihlcnJvcjogRXJyb3IpOiBib29sZWFuIHtcclxuICAgICAgICBjb25zdCBlcnJvckluZm8gPSA8RXJyb3JJbmZvPmVycm9yO1xyXG4gICAgICAgIGlmIChlcnJvckluZm8pIHtcclxuICAgICAgICAgICAgaWYgKFJFU1VMVF9DT0RFLkNBTkNFTEVEID09PSBlcnJvckluZm8uY29kZSB8fCBDQU5DRUxFRF9NRVNTQUdFID09PSBlcnJvckluZm8ubWVzc2FnZSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog5YWl5Yqb44KSIEVycm9ySW5mbyDjgavlpInmj5tcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gY2F1c2UgW2luXSDlhaXliptcclxuICAgICAqIEByZXR1cm5zIEVycm9ySW5mbyDjgqrjg5bjgrjjgqfjgq/jg4hcclxuICAgICAqL1xyXG4gICAgZXhwb3J0IGZ1bmN0aW9uIGVuc3VyZUVycm9ySW5mbyhjYXVzZT86IGFueSk6IEVycm9ySW5mbyB7XHJcbiAgICAgICAgY29uc3QgZXJyb3JJbmZvID0gPEVycm9ySW5mbz5jYXVzZTtcclxuICAgICAgICBjb25zdCB1bmtub3duOiBFcnJvckluZm8gPSB7XHJcbiAgICAgICAgICAgIG5hbWU6IFwiXCIsXHJcbiAgICAgICAgICAgIGNvZGU6IFJFU1VMVF9DT0RFLkZBSUxFRCxcclxuICAgICAgICAgICAgbWVzc2FnZTogXCJ1bmtub3duIGVycm9yXCIsXHJcbiAgICAgICAgfTtcclxuICAgICAgICBpZiAoZXJyb3JJbmZvKSB7XHJcbiAgICAgICAgICAgIGlmIChpc0NhbmNlbGVkRXJyb3IoZXJyb3JJbmZvKSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGVycm9ySW5mbztcclxuICAgICAgICAgICAgfSBlbHNlIGlmIChcInN0cmluZ1wiID09PSB0eXBlb2YgY2F1c2UpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB7IC4uLnVua25vd24sIC4uLnsgbWVzc2FnZTogY2F1c2UgfSB9O1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKFwib2JqZWN0XCIgPT09IHR5cGVvZiBjYXVzZSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHsgLi4udW5rbm93biwgLi4uY2F1c2UgfTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdW5rbm93bjtcclxuICAgIH1cclxuXHJcbiAgICBleHBvcnQgY29uc3QgTU9EVUxFX1JFU1VMVF9DT0RFX1JBTkdFX0NEUCA9IDEwMDtcclxuXHJcbiAgICAvKipcclxuICAgICAqIEBlbnVtICBSRVNVTFRfQ09ERV9CQVNFXHJcbiAgICAgKiBAYnJpZWYg44Oq44K244Or44OI44Kz44O844OJ44Gu44Kq44OV44K744OD44OI5YCkXHJcbiAgICAgKiAgICAgICAg44Ko44Op44O844Kz44O844OJ5a++5b+c44GZ44KL44Oi44K444Ol44O844Or5YaF44GnIOWumue+qeOCkuaLoeW8teOBmeOCiy5cclxuICAgICAqL1xyXG4gICAgZXhwb3J0IGVudW0gUkVTVUxUX0NPREVfQkFTRSB7XHJcbiAgICAgICAgQ0RQX0RFQ0xBUkVSQVRJT04gPSAwLCAvLyBUUzI0MzIg5a++562WOiDlkIzkuIAgbmFtZXNwYWNlIOOBq+ikh+aVsOWbnuOBq+OCj+OBn+OBo+OBpuWQjOWQjeOBriBlbnVtIOOCkuWuo+iogOOBmeOCi+WgtOWQiOOBq+W/heimgS5cclxuLy8gICAgICBNT0RVTEVfQSA9IDEgKiBNT0RVTEVfUkVTVUxUX0NPREVfUkFOR0UsICAgIC8vIGV4KSBtb2R1bGVBOiBhYnMoMTAwMSDvvZ4gMTk5OSlcclxuLy8gICAgICBNT0RVTEVfQiA9IDIgKiBNT0RVTEVfUkVTVUxUX0NPREVfUkFOR0UsICAgIC8vIGV4KSBtb2R1bGVCOiBhYnMoMjAwMSDvvZ4gMjk5OSlcclxuLy8gICAgICBNT0RVTEVfQyA9IDMgKiBNT0RVTEVfUkVTVUxUX0NPREVfUkFOR0UsICAgIC8vIGV4KSBtb2R1bGVDOiBhYnMoMzAwMSDvvZ4gMzk5OSlcclxuICAgICAgICBDRFAgPSAxICogTU9EVUxFX1JFU1VMVF9DT0RFX1JBTkdFX0NEUCwgICAgIC8vIGNkcCByZXNlcnZlZC4gYWJzKDAg772eIDEwMDApXHJcbiAgICB9XHJcbiAgICAvLyBcIkNEUFwiIOS7peWkluOBriBuYW1lc3BhY2Ug44Gn5a6a576p44GX44Gf5aC05ZCI44Gv44CBQVNTSUdOIOODpuODvOODhuOCo+ODquODhuOCo+OCkuOCs+ODvOODq+OBmeOCiy5cclxuLy8gIEFTU0lHTl9SRVNVTFRfQ09ERV9CQVNFKFJFU1VMVF9DT0RFX0JBU0UpO1xyXG5cclxuICAgIC8vIOOCteOCr+OCu+OCueOCs+ODvOODieeUn+aIkFxyXG4gICAgZXhwb3J0IGZ1bmN0aW9uIERFQ0xBUkVfU1VDQ0VTU19DT0RFKGJhc2U6IG51bWJlciB8IHN0cmluZywgbG9jYWxDb2RlOiBudW1iZXIsIG1lc3NhZ2U/OiBzdHJpbmcpOiBudW1iZXIge1xyXG4gICAgICAgIGlmIChcInN0cmluZ1wiID09PSB0eXBlb2YgYmFzZSkge1xyXG4gICAgICAgICAgICBiYXNlID0gQ0RQLlJFU1VMVF9DT0RFX0JBU0VbYmFzZV07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBkZWNsYXJlUmVzdWx0Q29kZSg8UkVTVUxUX0NPREVfQkFTRT5iYXNlLCBsb2NhbENvZGUsIG1lc3NhZ2UsIHRydWUpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIOOCqOODqeODvOOCs+ODvOODieeUn+aIkFxyXG4gICAgZXhwb3J0IGZ1bmN0aW9uIERFQ0xBUkVfRVJST1JfQ09ERShiYXNlOiBudW1iZXIgfCBzdHJpbmcsIGxvY2FsQ29kZTogbnVtYmVyLCBtZXNzYWdlPzogc3RyaW5nKTogbnVtYmVyIHtcclxuICAgICAgICBpZiAoXCJzdHJpbmdcIiA9PT0gdHlwZW9mIGJhc2UpIHtcclxuICAgICAgICAgICAgYmFzZSA9IENEUC5SRVNVTFRfQ09ERV9CQVNFW2Jhc2VdO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZGVjbGFyZVJlc3VsdENvZGUoPFJFU1VMVF9DT0RFX0JBU0U+YmFzZSwgbG9jYWxDb2RlLCBtZXNzYWdlLCBmYWxzZSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8g5oiQ5Yqf5Yik5a6aXHJcbiAgICBleHBvcnQgZnVuY3Rpb24gU1VDQ0VFREVEKGNvZGU6IG51bWJlcik6IGJvb2xlYW4ge1xyXG4gICAgICAgIHJldHVybiAwIDw9IGNvZGU7XHJcbiAgICB9XHJcblxyXG4gICAgLy8g5aSx5pWX5Yik5a6aXHJcbiAgICBleHBvcnQgZnVuY3Rpb24gRkFJTEVEKGNvZGU6IG51bWJlcik6IGJvb2xlYW4ge1xyXG4gICAgICAgIHJldHVybiBjb2RlIDwgMDtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFJFU1VMVF9DT0RFX0JBU0Ug44Gu44Ki44K144Kk44OzXHJcbiAgICAgKi9cclxuICAgIGV4cG9ydCBmdW5jdGlvbiBBU1NJR05fUkVTVUxUX0NPREVfQkFTRShyZXN1bHRDb2RlQmFzZTogb2JqZWN0KTogdm9pZCB7XHJcbiAgICAgICAgQ0RQLlJFU1VMVF9DT0RFX0JBU0UgPSA8YW55PnsgLi4uQ0RQLlJFU1VMVF9DT0RFX0JBU0UsIC4uLnJlc3VsdENvZGVCYXNlIH07XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBSRVNVTFRfQ09ERSDjga7jgqLjgrXjgqTjg7NcclxuICAgICAqL1xyXG4gICAgZXhwb3J0IGZ1bmN0aW9uIEFTU0lHTl9SRVNVTFRfQ09ERShyZXN1bHRDb2RlOiBvYmplY3QpOiB2b2lkIHtcclxuICAgICAgICBDRFAuUkVTVUxUX0NPREUgPSA8YW55PnsgLi4uQ0RQLlJFU1VMVF9DT0RFLCAuLi5yZXN1bHRDb2RlIH07XHJcbiAgICB9XHJcblxyXG4gICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cclxuICAgIC8vIG1vZHVsZSBlcnJvciBkZWNsYXJhdGlvbjpcclxuXHJcbiAgICBjb25zdCBGVU5DVElPTl9DT0RFX1JBTkdFID0gMTA7XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAZW51bSAgTE9DQUxfQ09ERV9CQVNFXHJcbiAgICAgKiBAYnJpZWYgY2RwLmNvcmUg5YaF44Gu44Ot44O844Kr44Or44Kz44O844OJ44Kq44OV44K744OD44OI5YCkXHJcbiAgICAgKi9cclxuICAgIGVudW0gTE9DQUxfQ09ERV9CQVNFIHtcclxuICAgICAgICBDT1JFICAgID0gMCxcclxuICAgICAgICBQQVRDSCAgID0gMSAqIEZVTkNUSU9OX0NPREVfUkFOR0UsXHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAZW51bSAgUkVTVUxUX0NPREVcclxuICAgICAqIEBicmllZiBjZHAuY29yZSDjga7jgqjjg6njg7zjgrPjg7zjg4nlrprnvqlcclxuICAgICAqICAgICAgICDjg6Ljgrjjg6Xjg7zjg6vliKXjgavmi6HlvLXlj6/og71cclxuICAgICAqL1xyXG4gICAgZXhwb3J0IGVudW0gUkVTVUxUX0NPREUge1xyXG4gICAgICAgIEVSUk9SX0NEUF9ERUNMQVJBVElPTl9DRFAgPSAwLCAvLyBUUzI0MzIg5a++562WOiDlkIzkuIAgbmFtZXNwYWNlIOOBq+ikh+aVsOWbnuOBq+OCj+OBn+OBo+OBpuWQjOWQjeOBriBlbnVtIOOCkuWuo+iogOOBmeOCi+WgtOWQiOOBq+W/heimgS5cclxuICAgICAgICBFUlJPUl9DRFBfSU5JVElBTElaRV9GQUlMRUQgPSBERUNMQVJFX0VSUk9SX0NPREUoUkVTVUxUX0NPREVfQkFTRS5DRFAsIExPQ0FMX0NPREVfQkFTRS5DT1JFICsgMSwgXCJpbml0aWFsaXplZCBmYWlsZWQuXCIpLFxyXG4gICAgfVxyXG4gICAgLy8gXCJDRFBcIiDku6XlpJbjga4gbmFtZXNwYWNlIOOBp+Wumue+qeOBl+OBn+WgtOWQiOOBr+OAgUFTU0lHTiDjg6bjg7zjg4bjgqPjg6rjg4bjgqPjgpLjgrPjg7zjg6vjgZnjgosuXHJcbi8vICBBU1NJR05fUkVTVUxUX0NPREVfQkFTRShSRVNVTFRfQ09ERSk7XHJcblxyXG4gICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cclxuICAgIC8vIHByaXZhdGUgc3RhdGljIG1ldGhvZHM6XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDjg6rjgrbjg6vjg4jjgrPjg7zjg4njga7nmbvpjLJcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gYmFzZSAgICAgICBbaW5dIFJFU1VMVF9DT0RFX0JBU0Ug44KS5oyH5a6aXHJcbiAgICAgKiBAcGFyYW0gbW9kdWxlQ29kZSBbaW5dIOODouOCuOODpeODvOODq+OBp+S4gOaEj+OBq+OBquOCi+aVsOWApCAoMCA8IGxvY2FsQ29kZSA8IDEwMDApXHJcbiAgICAgKiBAcGFyYW0gW21lc3NhZ2VdICBbaW5dIOODquOCtuODq+ODiOOCs+ODvOODieOBq+e0kOOBpeOBj+ODoeODg+OCu+ODvOOCuFxyXG4gICAgICogQHJldHVybnMg44Oq44K244Or44OI44Kz44O844OJXHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIGRlY2xhcmVSZXN1bHRDb2RlKGJhc2U6IFJFU1VMVF9DT0RFX0JBU0UsIG1vZHVsZUNvZGU6IG51bWJlciwgbWVzc2FnZT86IHN0cmluZywgc3VjY2VlZGVkOiBib29sZWFuID0gZmFsc2UpOiBudW1iZXIge1xyXG4gICAgICAgIGlmIChtb2R1bGVDb2RlIDw9IDAgfHwgTU9EVUxFX1JFU1VMVF9DT0RFX1JBTkdFIDw9IG1vZHVsZUNvZGUpIHtcclxuICAgICAgICAgICAgY29uc29sZS5lcnJvcihgZGVjbGFyZVJlc3VsdENvZGUoKSwgaW52YWxpZCBsb2NhbENvZGUgcmFuZ2UuIFtsb2NhbENvZGU6ICR7bW9kdWxlQ29kZX1dYCk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3Qgc2lnbmVkID0gc3VjY2VlZGVkID8gMSA6IC0xO1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdENvZGUgPSBzaWduZWQgKiAoYmFzZSArIG1vZHVsZUNvZGUpO1xyXG4gICAgICAgIHNfY29kZTJtZXNzYWdlW3Jlc3VsdENvZGVdID0gbWVzc2FnZSA/IG1lc3NhZ2UgOiAoYFtSRVNVTFRfQ09ERTogJHtyZXN1bHRDb2RlfV1gKTtcclxuICAgICAgICByZXR1cm4gcmVzdWx0Q29kZTtcclxuICAgIH1cclxuXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDjg6rjgrbjg6vjg4jjgrPjg7zjg4njgYvjgonnmbvpjLLjgZXjgozjgabjgYTjgovjg6Hjg4Pjgrvjg7zjgrjjgpLlj5blvpdcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gcmVzdWx0Q29kZSBbaW5dIOODquOCtuODq+ODiOOCs+ODvOODiVxyXG4gICAgICogQHJldHVybnMg44Ko44Op44O844Oh44OD44K744O844K4XHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIG1lc3NhZ2VGcm9tUmVzdWx0Q29kZShyZXN1bHRDb2RlOiBudW1iZXIpOiBzdHJpbmcge1xyXG4gICAgICAgIGlmIChzX2NvZGUybWVzc2FnZVtyZXN1bHRDb2RlXSkge1xyXG4gICAgICAgICAgICByZXR1cm4gc19jb2RlMm1lc3NhZ2VbcmVzdWx0Q29kZV07XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIGB1bnJlZ2lzdGVyZWQgcmVzdWx0IGNvZGUuIFtSRVNVTFRfQ09ERTogJHtyZXN1bHRDb2RlfV1gO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOODquOCtuODq+ODiOOCs+ODvOODieOBi+OCieeZu+mMsuOBleOCjOOBpuOBhOOCi+ODquOCtuODq+ODiOOCs+ODvOODieaWh+Wtl+WIl+OCkuWPluW+l1xyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSByZXN1bHRDb2RlIFtpbl0g44Oq44K244Or44OI44Kz44O844OJXHJcbiAgICAgKiBAcGFyYW0gdGFnICAgICAgICBbaW5dIFRBRyDjgpLmjIflrppcclxuICAgICAqIEByZXR1cm5zIOODquOCtuODq+ODiOOCs+ODvOODieitmOWIpeaWh+Wtl+WIl1xyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiBidWlsZEVycm9yTmFtZShyZXN1bHRDb2RlOiBudW1iZXIsIHRhZzogc3RyaW5nKTogc3RyaW5nIHtcclxuICAgICAgICBjb25zdCBwcmVmaXggPSB0YWcgfHwgXCJcIjtcclxuICAgICAgICBpZiAoUkVTVUxUX0NPREVbcmVzdWx0Q29kZV0pIHtcclxuICAgICAgICAgICAgcmV0dXJuIHByZWZpeCArIFJFU1VMVF9DT0RFW3Jlc3VsdENvZGVdICsgXCI6IFwiO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiBwcmVmaXg7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcbiJdfQ==